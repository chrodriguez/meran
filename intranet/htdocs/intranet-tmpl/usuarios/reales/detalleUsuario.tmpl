<link rel="stylesheet" type="text/css" href="[% temas %]/[% user_theme_intra %]/includes/fileuploader.css">

<script type="text/javascript" src="/includes/jquery/fileuploader.js"></script>
<script src="/includes/jquery/jquery.jeditable.js"></script>

<script type="text/javascript">
var loaderPath= "";
    $(document).ready(function(){
        makeToggle('toggle_container','trigger',null,true);
        loaderPath = '<img src="'+imagesForJS+'/loaders/loader_facebook.gif"'+'>';
        $('.nota').editable('[% url_prefix %]/usuarios/reales/usuariosRealesDB.pl', { 
              type      : 'textarea',
              cancel    : CANCELAR,
              submit    : OK,
              tooltip   : EDITABLE_MSG,
              placeholder: EDITABLE_MSG,
              style   : 'display: inline',
              submitdata : {token: "[% token %]", edit: '1', id: 'nota', nro_socio:'[% nro_socio %]' },
              indicator : loaderPath,
        });



    
        [% IF !foto_name %] 
            $('#div_uploader').show();
        [% ELSE %]
            $('#div_boton_eliminar_foto').show();
        [% END %]

        $('.fancylink').fancybox();

        //Inicializacion del FileUploader
        [% IF !foto_name %]  
            $('#label-file-uploader').show();
	        var uploader = new qq.FileUploader({
	            element: document.getElementById('file-uploader'),
	            action: '[% url_prefix %]/usuarios/reales/uploadPicture.pl',
	            params: {
	            	nro_socio: '[% nro_socio %]',
	            },
	            allowedExtensions: ["bmp","jpg","gif","png","jpeg"],
	            onComplete: function(id, fileName){detalleUsuario();},
	            debug: true,
	            multiple: false,
	        });
        [% ELSE %]
            $('#label-file-uploader').hide();
        [% END %]
        
    });
</script>

<div class="vcard">
[% IF needsDataValidation %]
    <h3 class="warning" style="padding: 20px;">[% "Los datos censales del socio necesitan ser validados. Por favor, s&iacute;rvase a realizar dicho proceso." | i18n %]</h3>
[% END %]
<fieldset>
<legend class="titulo_legend_resaltado">[% 'Datos del Usuario' | i18n %]</legend>
     <div class="columna_izq" >
          <fieldset>
            <legend class="titulo_legend_resaltado">[% 'Datos Esenciales' | i18n %]</legend>
                <ul class="listado_sin_margen">
                <li id="foto"> 
                  [% IF foto_name %]  
                      <a class="fancylink" rel="group" href="/uploads/pictures/[% foto_name %]">
	                      <img border="0" src="/uploads/pictures/[% foto_name %]"
	                            style="height: 60%; width: 60%; max-width: 120px; max-height: 120px;" 
	                            alt="[% socio.persona.getApellido %], [% socio.persona.getNombre %] ([% socio.getNro_socio %])"
	                            title="[% socio.persona.getApellido %], [% socio.persona.getNombre %] ([% socio.getNro_socio %])"
	                      >
	                  </a>
                  [% END %]
                </li>
                <li> [% "Apellido:" | i18n %]<strong> [% socio.persona.getApellido %]</strong> </li>
                <li> [% "Nombre:" | i18n %]<strong> [% socio.persona.getNombre %]</strong> </li>
                <li> [% "Documento:" | i18n %]<strong> [% socio.persona.getVersion_documento %]&nbsp; [% socio.persona.getNro_documento %]</strong></li>
                 [% IF !(socio.getNro_socio == socio.getNro_documento) %]
                     <li> [% "Tarjeta de identificaci&oacute;n :" | i18n %] <strong> [% socio.getNro_socio %]</strong></li>
                  [% END %]
                <li>[% "Categor&iacute;a del usuario:" | i18n %] <strong> [%  socio.categoria.getDescription %]</strong></li>
                <li> [% "Credenciales" | i18n %]:<strong> [% socio.getCredentialType %]</strong> </li>
                </ul>
          </fieldset>
    [% IF socio.tieneAutorizado %]
        <fieldset>
            <legend class="titulo_legend_resaltado">[% 'Usuario adicional' | i18n %]</legend>
              <div class="authorizedBack">
                  <ul class="listado_sin_margen">
                      <li>
                          [% "Nombre y Apellido" | i18n %]:<span id="nombre_autorizado" class="strong" > [% socio.getNombre_apellido_autorizado%]</span>
                      </li>
                      <li>
                            [% "DNI" | i18n %]:<span id="dni_autorizado" class="strong" >  [% socio.getDni_autorizado %]</span>
                      </li>
                      <li>
                          [% "Tel&eacute;fono" | i18n %]:<span id="telefono_autorizado" class="strong" >[% socio.getTelefono_autorizado %]</span>
                      </li>
                  </ul>
              </div>
        </fieldset>
     [% END %]
        <div id="datos_Secundarios">
        <fieldset>
            <legend class="titulo_legend_resaltado trigger click titulo_legend" title='[% "click para acceder a informaci&oacute;n adicional" | i18n %]'>
                    [% "Datos secundarios" | i18n %]
            </legend>
            <div class="toggle_container">
                <ul class="listado_sin_margen">
                    <li>[% "Fecha de nacimiento:" | i18n %] <strong> [% socio.persona.getNacimiento %]</strong></li>
                    <li>[% "Sexo:" | i18n %] <strong> [% socio.persona.getSexoPrint %]</strong> </li>
                    [% IF socio.persona.getTelefono %]
                    <li> <div class="tel">[% "Tel&eacute;fono:" | i18n %]<strong>[% socio.persona.getTelefono %]</strong></div></li>  
                    [% END %]
                    [% IF socio.persona.getAlt_telefono %]
                    <li> <div class="tel">[% "Tel&eacute;fono Alt:" | i18n %] <strong>[% socio.persona.getAlt_telefono %]</strong></div></li>  
                    [% END %]
                    [% IF socio.persona.getEmail %]
                    <li>E-mail: <strong><a href="mailto:[% socio.persona.getEmail %]">[% socio.persona.getEmail %]</a></strong></li>
                    [% END %]
                    <li>[% "Legajo :" | i18n %] <strong> [%  socio.persona.getLegajo %]</strong></li>
                    <li>[% "Ciudad :" | i18n %] <strong> [%  socio.persona.ciudad_ref.getNombre %]</strong></li>
                    <li>[% "Calle :" | i18n %]  <strong> [%  socio.persona.getCalle %]</strong></li>
                    <li>[% "ID de usuario:" | i18n %] <strong> [%  socio.nro_socio %]</strong></li>
                    <li>[% "Incorporaci&oacute;n a Biblioteca:" | i18n %] <strong> [%  socio.ui.nombre %]</strong></li>
                    [% IF usercourse %]
                    <li>
                    <center>
                      <strong>
                          [% "Realiz&oacute; el curso para usuarios. Dado de alta el d&iacute;a" | i18n %]
                          [% usercourse %]
                      </strong>
                    </center>
                    </li>
                    [% END %]
                    <li>[% "Instituci&oacute;n :" | i18n %] <strong> [% socio.persona.getInstitucion %]</strong></li>
                    <li>[% "Carrera :" | i18n %] <strong> [%  socio.persona.getCarrera %]</strong></li>
                    <li>[% "A&ntilde;o :" | i18n %] <strong> [%  socio.persona.getAnio %]</strong></li>
                    <li>[% "Divisi&oacute;n :" | i18n %] <strong> [%  socio.persona.getDivision %]</strong></li>
                </ul>
            </div>
        </fieldset>

        <fieldset>
            <legend class="titulo_legend_resaltado trigger click titulo_legend" title='[% "click para acceder a las notas registradas sobre el usuario" | i18n %]'>
                    [% "Notas" | i18n %]
            </legend>
            <div class="toggle_container" >
                   <div class="nota">[% notas %]</div>
            </div>
        </fieldset>

      

        </div>
</div><!--columna izq -->

<div class="columna_der" >
          <fieldset  class="accionesUsuarios" style="clear:none" >
                <legend class ="titulo_legend_resaltado">[% 'Acciones' | i18n %]</legend>
                    <ul class ="listaMenuBotones" >
                        [% IF needsDataValidation %]
	                        <li>
	                            [% PERL %]
                                                print C4::AR::Filtros::to_Button(   text    => "[% 'Validar datos Censales' | i18n %]",
                                                                                    boton   => "boton_buscar",
                                                                                    onClick => "validarDatosCensales();",
                                                        ) ;
	                            [% END %]
	                        </li>
                        [% END %]
                        <li>
                            [% PERL %]
                                                print C4::AR::Filtros::to_Button(   text    => "[% 'Modificar Datos' | i18n %]",
                                                                                    boton   => "boton_buscar",
                                                                                    onClick => "modificarDatosDeUsuario();",
                                                        ) ;
                            [% END %]
                        </li>
                        <li>
                            [% PERL %]
                                                print C4::AR::Filtros::to_Button(   text    => "[% 'Eliminar Usuario' | i18n %]",
                                                                                    boton   => "boton_buscar",
                                                                                    onClick => "eliminarUsuario();",
                                                        ) ;
                            [% END %]
                            </li>
                        [% IF !socio.tieneAutorizado %]
                            <li>
    
                            [% PERL %]
                                                print C4::AR::Filtros::to_Button(   text    => "[% 'Agregar Usuario Adicional' | i18n %]",
                                                                                    boton   => "boton_buscar",
                                                                                    onClick => "agregarAutorizado();",
                                                        ) ;
                            [% END %]
                            </li>
                        [% ELSE %]
                            <li>
                            [% PERL %]
                                                print C4::AR::Filtros::to_Button(   text    => "[% 'Eliminar Usuario Adicional' | i18n %]",
                                                                                    boton   => "boton_buscar",
                                                                                    onClick => "desautorizarTercero();",
                                                        ) ;
                            [% END %]
                            </li>
                        [% END %]
                        [% IF socio_data.usr_nro_socio != nro_socio %]
                            <li>
                            [% PERL %]
                                                print C4::AR::Filtros::to_Button(   text    => "[% 'Reestablecer contrase&ntilde;a' | i18n %]",
                                                                                    boton   => "boton_buscar",
                                                                                    onClick => "resetPassword();",
                                                        ) ;
                            [% END %]
                            </li>
                        [% ELSE %]
                            <li>  
                                    <form action=[% url_prefix %]/usuarios/change_password.pl method=get id="formCambioPassword">
                                        <input type=hidden name="token" value="[% token %]" >
                                    </form>        
      
                            [% PERL %]
                                                print C4::AR::Filtros::to_Button(   text    => "[% 'Cambio de Contrase&ntilde;a' | i18n %]",
                                                                                    boton   => "boton_buscar",
                                                                                    onClick => "cambiarPassword();",
                                                        ) ;
                            [% END %]
                            </li>
                        [% END %]
                            <li>
                                <form action=[% url_prefix %]/usuarios/cardGenerator.pl method=get name="formCarnet">
                                    <input type=hidden name="nro_socio" value="[% socio.getNro_socio %]" >
                                    <input type=hidden name="token" value="[% token %]" >
                                </form>
        
                            [% PERL %]
                                    print C4::AR::Filtros::to_Button(   text    => "[% 'Generar Carnet' | i18n %]",
                                                                        boton   => "boton_buscar",
                                                                        onClick => "formCarnet.submit();",
                                            ) ;

                            [% END %]
                        </li>
                        <li>
                            [% PERL %]
                                        print C4::AR::Filtros::to_Button(   text    => "[% 'Libre Deuda' | i18n %]",
                                                                            boton   => "boton_buscar",
                                                                            onClick => "generarLibreDeuda();",
                                                ) ;
                            [% END %]
                       </li>
                       <li>
                            [% PERL %]
                                        print C4::AR::Filtros::to_Button(   text    => "[% 'Prest. Interbibliotecario' | i18n %]",
                                                                            boton   => "boton_buscar",
                                                                            onClick => "prestamosInterBibliotecarios();",
                                                ) ;
                            [% END %]
                      </li>

                      [% IF mensaje_error_foto %] 
                        <li>
                                <font color="red">[% mensaje_error_foto %]</font>
                        </li>
                      [% END %]

                       <div id="div_boton_eliminar_foto" style="display: none">
                          <li>
                                [% PERL %]
                                            print C4::AR::Filtros::to_Button(   text    => "[% 'Eliminar Foto' | i18n %]",
                                                                                boton   => "boton_borrar",
                                                                                onClick => "eliminarFoto('[% foto_name %] ');",
                                                                             );
                                [% END %]
                          </li>
                        </div>
                        <li>
                            <label for="file-uploader" id="label-file-uploader">
                                <h6>[% 'Seleccione una im&aacute;gen' | i18n %]</h6>
                            </label>
	                        <div id="file-uploader">
							    <noscript>          
							        <p>[% 'Please enable JavaScript to use file uploader.' | i18n %]</p>
							        <!-- or put a simple form for upload here -->
							    </noscript>                          
	                        </div>
                        </li>
                    </ul>
                </fieldset>
              </div><!--columna_der -->
</fieldset>
</div><!--vcard -->
<div id="basic-modal-content"></div>
