[% INCLUDE "intranet-top.inc" %]

<script language="javascript" type="text/javascript">

$(document).ready(function() {
    crearDatePicker('fechaIni');
    crearDatePicker('fechaFin');

});
</script>

<script type="text/javascript">

    var objAH;

    function ordenar(orden){
        objAH.sort(orden);
    }

    function changePage(ini){
        objAH.changePage(ini);
    }

    function updateInfo(responseText){
        $('#result').html(responseText);
        zebra('tablaResult');
        objAH.id="";
        objAH.notas="";
    }

    function consultar(){
        objAH=new AjaxHelper(updateInfo);
        objAH.url= '/cgi-bin/koha/reports/historicoCirculacionResult.pl';
        objAH.fechaIni=  $('#fechaIni').val();
        objAH.fechaFin= $('#fechaFin').val();
        objAH.chkfecha=  $('#chkfecha')[0].checked;
        objAH.socio= $('#socios').val();
        objAH.tipoPrestamo= $('#tipo_prestamo_id').val();
        objAH.tipoOperacion= $('#tipoOperacion').val();
        //se setea la funcion para cambiar de pagina
        objAH.funcion= 'changePage';
        objAH.sendToServer();

    }

    function guardarNota(id_historico){
        objAH=new AjaxHelper(updateGuardarNota);
        objAH.id_historico= id_historico;
        objAH.nota= $('#'+id_historico).val();
        objAH.url= '/cgi-bin/koha/reports/historicoCirculacionResult.pl';
        //se setea la funcion para cambiar de pagina
        objAH.accion= 'NOTA_HISTORICO';
        objAH.sendToServer();
    }
    function updateGuardarNota(responseText){
        if (responseText != '0')
            jAlert(NOTA_GUARDADA);
        else
            jAlert(FALLO_NOTA);
    }

</script>

<div class="titulos" >[% "Registro de Circulaci&oacute;n" | i18n %]</div>


<div class="filtros_reportes">

    <ul class="filtros_reportes_izq">
        <li>
            <b>[% "Seleccione para buscar por fecha" | i18n %].</b>
            <input type="checkbox" id="chkfecha">
        </li>
        <li>
            [% "Seleccione una fecha de inicio:" | i18n %]
            <input id="fechaIni" name="dateselected" value="
                                [% IF fechaInicio %]
                                    [% dateselected %]
                                [% ELSE %]
                                    [% todaydate %]
                                [% END %] "
                        >
        </li>
        <li>
            [% "Seleccione una fecha de fin" | i18n %]:
            <input id="fechaFin" name="dateselectedEnd" value="
                    [% IF fechaFin %]
                        [% dateselectedEnd %]
                    [% ELSE %]
                        [% todaydate %]
                    [% END %]"
            >
        </li>
    </ul>
    <ul class="filtros_reportes_der">

        <li><b>[% "Filtrar por:" | i18n %]</b></li>
        <li>
            <b>[% "Responsable:" | i18n %]</b>[% selectusuarios %]
        </li>
        <li>
            <b>[% "Tipo de Pr&eacute;stamo: " | i18n %]</b>
            [% selectTipoPrestamos %]
        </li>
        <li>
            <b>[% "Tipo de Operaci&oacute;n: " | i18n %]</b>
            [% selectTipoOperacion %]
        </li>
    </ul>
</div>
<div class="buttonContainerHorizontal">
    [% PERL %]
            print C4::AR::Filtros::to_Button( 
                                                text    =>  "[% 'Buscar' | i18n %]",
                                                title    =>  "[% 'Buscar' | i18n %]",
                                                boton   =>  "boton_buscar",
                                                onClick =>  "consultar();",
                                            );
    [% END %]
</div>
<div id="result"></div>

[% INCLUDE "intranet-bottom.inc" %]
