<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- TMPL_IF Name="fillinput"-->
	<body>
		<script language="JavaScript" type="text/javascript">
		
			function go() {
			var index_start = <!-- TMPL_VAR NAME="index" -->;
			var whichfield = opener.opener.document.f.tag[index_start].value;
			i=index_start
			// go forward, until reaching the end of the field.
			while (i<opener.opener.document.f.field_value.length) {
				if (opener.opener.document.f.tag[i].value == whichfield && opener.opener.document.f.subfield[i].value == '9') {
					opener.opener.document.f.field_value[i].value = "<!-- TMPL_VAR NAME="subfield_value_9" -->";
				}
				if (opener.opener.document.f.tag[i].value == whichfield && opener.opener.document.f.subfield[i].value == '0') {
					opener.opener.document.f.field_value[i].value = "<!-- TMPL_VAR NAME="subfield_value_0" -->";
				}
				if (opener.opener.document.f.tag[i].value == whichfield && opener.opener.document.f.subfield[i].value == 'a') 
				{
					opener.opener.document.f.field_value[i].value = "<!-- TMPL_VAR NAME="subfield_value_a" -->";
				}
				if (opener.opener.document.f.tag[i].value == whichfield && opener.opener.document.f.subfield[i].value == 'c') 
				{
					opener.opener.document.f.field_value[i].value = "<!-- TMPL_VAR NAME="subfield_value_c" -->";
				}
				if (opener.opener.document.f.tag[i].value == whichfield && opener.opener.document.f.subfield[i].value == 'd') 
				{
					opener.opener.document.f.field_value[i].value = "<!-- TMPL_VAR NAME="subfield_value_d" -->";
				}
				if (opener.opener.document.f.tag[i].value == whichfield && opener.opener.document.f.subfield[i].value == 'e') 
				{
					opener.opener.document.f.field_value[i].value = "<!-- TMPL_VAR NAME="subfield_value_e" -->";
				}
				if (opener.opener.document.f.tag[i].value == whichfield && opener.opener.document.f.subfield[i].value == 'h') 
				{
					opener.opener.document.f.field_value[i].value = "<!-- TMPL_VAR NAME="subfield_value_h" -->";
				}
				if (opener.opener.document.f.tag[i].value == whichfield && opener.opener.document.f.subfield[i].value == 'i') 
				{
					opener.opener.document.f.field_value[i].value = "<!-- TMPL_VAR NAME="subfield_value_i" -->";
				}
				if (opener.opener.document.f.tag[i].value == whichfield && opener.opener.document.f.subfield[i].value == 'p') 
				{
					opener.opener.document.f.field_value[i].value = "<!-- TMPL_VAR NAME="subfield_value_p" -->";
				}
				if (opener.opener.document.f.tag[i].value == whichfield && opener.opener.document.f.subfield[i].value == 't') 
				{
					opener.opener.document.f.field_value[i].value = "<!-- TMPL_VAR NAME="subfield_value_t" -->";
				}
				if (opener.opener.document.f.tag[i].value == whichfield && opener.opener.document.f.subfield[i].value == 'u') 
				{
					opener.opener.document.f.field_value[i].value = "<!-- TMPL_VAR NAME="subfield_value_u" -->";
				}
				if (opener.opener.document.f.tag[i].value == whichfield && opener.opener.document.f.subfield[i].value == 'v') 
				{
					opener.opener.document.f.field_value[i].value = "<!-- TMPL_VAR NAME="subfield_value_v" -->";
				}
				if (opener.opener.document.f.tag[i].value == whichfield && opener.opener.document.f.subfield[i].value == 'x') 
				{
					opener.opener.document.f.field_value[i].value = "<!-- TMPL_VAR NAME="subfield_value_x" -->";
				}
				if (opener.opener.document.f.tag[i].value == whichfield && opener.opener.document.f.subfield[i].value == 'y') 
				{
					opener.opener.document.f.field_value[i].value = "<!-- TMPL_VAR NAME="subfield_value_y" -->";
				}
				if (opener.opener.document.f.tag[i].value != whichfield) {
					i=opener.opener.document.f.field_value.length;
				}
				i++;
			}
			// go backward until the beginning of the field
			i=index_start
			while (i>=0) {
				if (opener.opener.document.f.tag[i].value == whichfield && opener.opener.document.f.subfield[i].value == '0') {
					opener.opener.document.f.field_value[i].value = "<!-- TMPL_VAR NAME="subfield_value_0">";
				}
				if (opener.opener.document.f.tag[i].value == whichfield && opener.opener.document.f.subfield[i].value == '9') {
					opener.opener.document.f.field_value[i].value = "<!-- TMPL_VAR NAME="subfield_value_9">";
				}
				if (opener.opener.document.f.tag[i].value == whichfield && opener.opener.document.f.subfield[i].value == 'a') 
				{
					opener.opener.document.f.field_value[i].value = "<!-- TMPL_VAR NAME="subfield_value_a" -->";
				}
				if (opener.opener.document.f.tag[i].value == whichfield && opener.opener.document.f.subfield[i].value == 'c') 
				{
					opener.opener.document.f.field_value[i].value = "<!-- TMPL_VAR NAME="subfield_value_c" -->";
				}
				if (opener.opener.document.f.tag[i].value == whichfield && opener.opener.document.f.subfield[i].value == 'd') 
				{
					opener.opener.document.f.field_value[i].value = "<!-- TMPL_VAR NAME="subfield_value_d" -->";
				}
				if (opener.opener.document.f.tag[i].value == whichfield && opener.opener.document.f.subfield[i].value == 'e') 
				{
					opener.opener.document.f.field_value[i].value = "<!-- TMPL_VAR NAME="subfield_value_e" -->";
				}
				if (opener.opener.document.f.tag[i].value == whichfield && opener.opener.document.f.subfield[i].value == 'h') 
				{
					opener.opener.document.f.field_value[i].value = "<!-- TMPL_VAR NAME="subfield_value_h" -->";
				}
				if (opener.opener.document.f.tag[i].value == whichfield && opener.opener.document.f.subfield[i].value == 'i') 
				{
					opener.opener.document.f.field_value[i].value = "<!-- TMPL_VAR NAME="subfield_value_i" -->";
				}
				if (opener.opener.document.f.tag[i].value == whichfield && opener.opener.document.f.subfield[i].value == 'p') 
				{
					opener.opener.document.f.field_value[i].value = "<!-- TMPL_VAR NAME="subfield_value_p" -->";
				}
				if (opener.opener.document.f.tag[i].value == whichfield && opener.opener.document.f.subfield[i].value == 't') 
				{
					opener.opener.document.f.field_value[i].value = "<!-- TMPL_VAR NAME="subfield_value_t" -->";
				}
				if (opener.opener.document.f.tag[i].value == whichfield && opener.opener.document.f.subfield[i].value == 'u') 
				{
					opener.opener.document.f.field_value[i].value = "<!-- TMPL_VAR NAME="subfield_value_u" -->";
				}
				if (opener.opener.document.f.tag[i].value == whichfield && opener.opener.document.f.subfield[i].value == 'v') 
				{
					opener.opener.document.f.field_value[i].value = "<!-- TMPL_VAR NAME="subfield_value_v" -->";
				}
				if (opener.opener.document.f.tag[i].value == whichfield && opener.opener.document.f.subfield[i].value == 'x') 
				{
					opener.opener.document.f.field_value[i].value = "<!-- TMPL_VAR NAME="subfield_value_x" -->";
				}
				if (opener.opener.document.f.tag[i].value == whichfield && opener.opener.document.f.subfield[i].value == 'y') 
				{
					opener.opener.document.f.field_value[i].value = "<!-- TMPL_VAR NAME="subfield_value_y" -->";
				}
				if (opener.opener.document.f.tag[i].value != whichfield) {
					i=0;
				}
				i--;
			}
				return false;
			}
		</script>
		<script language="javascript" type="text/javascript">
			window.onload = go();
			opener.close();
			self.close();
		</script>
	</body>
<!-- TMPL_ELSE -->
	<head>
		<title>KOHA:INTRANET : Biblio Search</title>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	
	<script language="JavaScript" type="text/javascript">
	function Help() {
		newin=window.open("/cgi-bin/koha/help.pl","Koha Help",'width=600,height=600,toolbar=false,scrollbars=yes');
	}
	
	</script>
	
	<link rel="stylesheet" type="text/css" href="<!-- TMPL_VAR name="themelang" -->/includes/common-style.css">
	<style type="text/css">
	.catalogue {
		background-color:#ad11ad;
		color:#FFFFFF;
		background-image:none;
		text-decoration: normal;
		}
	a.catalogue:hover {
		background-color: #ad11ad;
		color: #FFFFFF;
		text-decoration: none;
		}
	
	</style>
	</head>
	
	<body>
		<script>
			function report(value2report) {
				if (document.f_pop.result.value.length==0) {
					document.f_pop.result.value = value2report;
				} else {
					document.f_pop.result.value = document.f_pop.result.value+'|'+value2report;
				}
				return true;
			}
		</script>
		<script>
			function finish() {
				opener.document.f.field_value[<!-- TMPL_VAR name="index" -->].value= document.f_pop.result.value;
				self.close();
				return false;
			}
		</script>
	<!-- MENUS -->
	<!-- TMPL_IF NAME="loggedinusername" -->
		<p align="left">Logged in as: <!-- TMPL_VAR NAME="loggedinusername" --> [<a href="/cgi-bin/koha/mainpage.pl?logout.x=1">Log Out</a>]</p>
	<!-- TMPL_ELSE -->
		<p align="left"><a href="/cgi-bin/koha/opac-user.pl">Log In</a> to Koha</p>
	<!-- /TMPL_IF --></head>
	<div id="mainbloc">
	<h1 class="catalogue" >KOHA : INTRANET : Catalogue </h1>
	<!--TMPL_IF Name = "Search"-->
		<div id="bloc25">
		<h2 class="catalogue" > Search On  </h2>
		<form name="f" method="post" action="/cgi-bin/koha/plugin_launcher.pl?plugin_name=unimarc_field_4XX.pl">
	
			<p>
				<input type="hidden" name="plugin_name" value="unimarc_field_4XX.pl">
				<input type="hidden" name="index" value="<!--TMPL_VAR Name="index" -->">
				<input type="hidden" name="result" value="unimarc field 4 <!--TMPL_VAR Name="index" -->">
				<input type="hidden" name="plugin_name" value="unimarc_field_4XX.pl">
				<input type="hidden" name="op" value="do_search">
				<label class="label100" for="keyword">Any word</label>
				<input type="hidden" name="marclist" value="">
				<input type="hidden" name="and_or" value="and">
				<input type="hidden" name="excluding" value="">
				<input type="hidden" name="operator" value="contains">
				<input type="text" name="value" id="keyword" onchange="sql_update()" size="35">
			</p>
			<p>
				<label class="label100" for="title">Title</label>
				<input type="hidden" name="marclist" value="biblio.title">
				<input type="hidden" name="and_or" value="and">
				<input type="hidden" name="excluding" value="">
				<input type="hidden" name="operator" value="contains">
				<input type="text" name="value" id="title" onchange="sql_update()" size="35">
			</p>
			<p>
				<label class="label100" for="author">Author</label> <input type="hidden" name="marclist" value="biblio.author">
				<input type="hidden" name="and_or" value="and">
				<input type="hidden" name="excluding" value="">
				<input type="hidden" name="operator" value="contains">
				<input type="text" name="value" id="author" onchange="sql_update()" size="35">
			</p>
			<p>
				<label class="label100" for="itemtype">Item Type</label>
				<input type="hidden" name="marclist" value="biblioitems.itemtype">
				<input type="hidden" name="and_or" value="and">
				<input type="hidden" name="excluding" value="">
				<input type="hidden" name="operator" value="=">
				<!-- TMPL_VAR name="CGIitemtype" -->
			</p>
			<p>
					<label class="label100" for="branch">Branch</label>
					<input type="hidden" name="marclist" value="items.holdingbranch">
					<input type="hidden" name="and_or" value="and">
					<input type="hidden" name="excluding" value="">
					<input type="hidden" name="operator" value="=">  
					<!-- TMPL_VAR name="CGIbranch" -->
			</p>
			<h2 class="catalogue">Other options</h2>
			<p>
				<label class="label100" for="callno">Call Number</label>
				<input type="hidden" name="marclist" value="items.itemcallnumber">
				<input type="hidden" name="and_or" value="and">
				<input type="hidden" name="excluding" value="">
				<input type="hidden" name="operator" value="start">
				<input type="text" name="value" id="callno" onchange="sql_update()">
			</p>
			<p>
				<label class="label100" for="isbn">ISBN</label>
				<input type="hidden" name="marclist" value="biblioitems.isbn">
				<input type="hidden" name="and_or" value="and">
				<input type="hidden" name="excluding" value="">
				<input type="hidden" name="operator" value="=">
				<input type="text" name="value" id="isbn" onchange="sql_update()">
			</p>
			<p>
				<label class="label100" for="publisher">Publisher</label>
				<input type="hidden" name="marclist" value="biblioitems.publishercode">
				<input type="hidden" name="and_or" value="and">
				<input type="hidden" name="excluding" value="">
				<input type="hidden" name="operator" value="contains">
				<input type="text" name="value" id="publisher" onchange="sql_update()">
	
			</p>
		</div>
		<div class="bloc25">
			<p><textarea name="sql" rows="3" cols="70" disabled readonly></textarea></p>
			<p>Results per page :
				<select name="resultsperpage" size="1">
					<option value="20">20</option>
					<option value="50">50</option>
					<option value="100">100</option>
				</select>
			Ordered by
				<select name="orderby" size="1">
					<option value="biblio.title">Title</option>
					<option value="biblio.author">Author</option>
					<option value="biblioitems.dewey">Dewey</option>
					<option value="biblioitems.publicationyear">Publication Year</option>
					<option value="biblioitems.publishercode">Publisher</option>
				</select>
			<p>
			<p><input type="hidden" name="index" value="<!--TMPL_VAR Name="index" -->"></p>
			<p>
				<input type="submit" value="Start search" class="button catalogue">
				<input type="reset"  value="Clear All Fields" class="button catalogue">
			</p>
	
			<script language="javascript" type="text/javascript">
			function sql_update() {
			document.f.sql.value="";
				for (i=0 ; i<document.f.marclist.length ; i++) {
					if (document.f.value[i].value.length>0) {
						document.f.sql.value = document.f.sql.value+
													document.f.and_or[i].value + ' (' +
													document.f.excluding[i].value + ' ' +
													document.f.marclist[i].value + ' ' +
													document.f.operator[i].value + ' ' +
													'\''+document.f.value[i].value + '\') ';
					}
				}
			}
			</script>
		</div>
	</form>
	
	<!--TMPL_ELSE-->
	

		<h2 class="catalogue">Search results</h2>
		<div id="resultnumber">
			<p><!-- TMPL_IF NAME="displayprev" --> <a class="resultnumber" href="/cgi-bin/koha/plugin_launcher.pl?plugin_name=unimarc_field_4XX.pl&amp;index=<!--TMPL_VAR Name="index"-->&amp;startfrom=<!-- TMPL_VAR NAME="startfromprev" -->&amp;<!-- TMPL_LOOP NAME="searchdata" --><!-- TMPL_VAR NAME="term" -->=<!-- TMPL_VAR NAME="val" ESCAPE=URL -->&amp;<!-- /TMPL_LOOP -->resultsperpage=<!-- TMPL_VAR NAME="resultsperpage" -->&amp;type=intranet&amp;op=do_search">&lt;&lt;Previous</a><!-- /TMPL_IF -->
				<!-- TMPL_LOOP NAME="numbers" --><!-- TMPL_IF NAME="highlight" --> <span class="highlight"><!-- TMPL_VAR NAME="number" --></span><!-- TMPL_ELSE --> <a class="resultnumber" href="/cgi-bin/koha/plugin_launcher.pl?plugin_name=unimarc_field_4XX.pl&amp;index=<!--TMPL_VAR Name="index"-->&amp;startfrom=<!-- TMPL_VAR NAME="startfrom" -->&amp;<!-- TMPL_LOOP NAME="searchdata" --><!-- TMPL_VAR NAME="term" -->=<!-- TMPL_VAR NAME="val" ESCAPE=URL -->&amp;<!-- /TMPL_LOOP -->resultsperpage=<!-- TMPL_VAR NAME="resultsperpage" -->&amp;type=intranet&amp;op=do_search"><!-- TMPL_VAR NAME="number" --></a><!-- /TMPL_IF --><!-- /TMPL_LOOP --> <!-- TMPL_IF NAME="displaynext" --><a class="resultnumber" href="/cgi-bin/koha/plugin_launcher.pl?plugin_name=unimarc_field_4XX.pl&amp;index=<!--TMPL_VAR Name="index"-->&amp;startfrom=<!-- TMPL_VAR NAME="startfromnext" -->&amp;<!-- TMPL_LOOP NAME="searchdata" --><!-- TMPL_VAR NAME="term" -->=<!-- TMPL_VAR NAME="val" ESCAPE=URL -->&amp;<!-- /TMPL_LOOP -->&amp;resultsperpage=<!-- TMPL_VAR NAME="resultsperpage" -->&amp;type=intranet&amp;op=do_search">Next&gt;&gt;</a><!-- /TMPL_IF --></p>
			<p class="resultcount"><!-- TMPL_IF NAME="total" -->Results <!-- TMPL_VAR NAME="from" --> to <!-- TMPL_VAR NAME="to" --> of <!-- TMPL_VAR NAME="total" --><!-- TMPL_ELSE -->No results found.<!-- /TMPL_IF --></p></div>
		<div id="resultlist">
			<table>
				<tr>
					<th class="catalogue">Summary</th>
					<th class="catalogue">Item Count</th>
					<th class="catalogue">Location</th>
					<th class="catalogue">&nbsp;</th>
				</tr>
				<!-- TMPL_LOOP NAME="result" -->
				<tr>
					<td<!-- TMPL_IF NAME="even" --> class="hilighted"<!-- /TMPL_IF -->>
								<!-- TMPL_IF name="MARC_ON" -->
									<a class="transparent resultlist" href="/cgi-bin/koha/MARCdetail.pl?bib=<!-- TMPL_VAR NAME="biblionumber" ESCAPE="URL" -->"><!-- TMPL_VAR NAME="title" --></a>
								<!-- TMPL_ELSE -->
									<a class="transparent resultlist" href="/cgi-bin/koha/detail.pl?bib=<!-- TMPL_VAR NAME="biblionumber" ESCAPE="URL" -->"><!-- TMPL_VAR NAME="title" --></a>				<!-- /TMPL_IF -->
							<p><!-- TMPL_VAR NAME="author" -->
							<!-- TMPL_IF NAME="publishercode" -->- <!-- TMPL_VAR NAME="publishercode" --><!-- /TMPL_IF -->
							<!-- TMPL_IF NAME="place" --> ; <!-- TMPL_VAR NAME="place" --><!-- /TMPL_IF -->
							<!-- TMPL_IF NAME="pages" --> - <!-- TMPL_VAR NAME="pages" --><!-- /TMPL_IF -->
							<!-- TMPL_IF NAME="notes" --> : <!-- TMPL_VAR NAME="notes" --><!-- /TMPL_IF -->
							<!-- TMPL_IF NAME="size" --> ; <!-- TMPL_VAR NAME="size" --><!-- /TMPL_IF -->
						</p>
					</td>
					<td align="center" <!-- TMPL_IF NAME="even" --> class="hilighted"<!-- /TMPL_IF -->>
						<!-- TMPL_VAR NAME="totitem" -->
					</td>
					<td <!-- TMPL_IF NAME="even" -->class="hilighted"<!-- /TMPL_IF -->>
						<!-- TMPL_LOOP NAME="CN" -->
							<p>
								<!-- TMPL_VAR NAME="holdingbranch" -->
								<!-- TMPL_IF name="date_due" -->
									On Loan until <!-- TMPL_VAR NAME="date_due" -->
								<!-- TMPL_ELSE -->
									<!-- TMPL_IF NAME="itemcallnumber" -->
										(<!-- TMPL_VAR NAME="itemcallnumber" -->)
									<!-- /TMPL_IF -->
								<!-- /TMPL_IF -->
								<!-- TMPL_IF name="notforloan" -->
									<i>(<!-- TMPL_VAR name="notforloan" -->)</i>
								<!-- /TMPL_IF -->
							</p>
						<!-- /TMPL_LOOP -->
						<!-- TMPL_IF name="onorder" --><p>On order</p><!-- /TMPL_IF -->
					</td>
					<td>
						<a href="javascript:jumpfull('/cgi-bin/koha/plugin_launcher.pl?plugin_name=unimarc_field_4XX.pl&index=<!--TMPL_VAR Name="index"-->&bibnum=<!--TMPL_VAR Name="biblionumber"-->&type=intranet&op=fillinput')"><img src="<!-- TMPL_VAR NAME="interface" -->/<!-- TMPL_VAR NAME="theme" -->/images/arrow.gif" width="32" hspace="0" vspace="0" border="0"></a>
					</td>
	
				</tr>
				<!-- /TMPL_LOOP -->
			</table>
		</div>
		<div id="resultnumber">
			<p><!-- TMPL_IF NAME="displayprev" --> <a class="resultnumber" href="/cgi-bin/koha/plugin_launcher.pl?plugin_name=unimarc_field_4XX.pl&amp;index=<!--TMPL_VAR Name="index"-->&amp;startfrom=<!-- TMPL_VAR NAME="startfromprev" -->&amp;<!-- TMPL_LOOP NAME="searchdata" --><!-- TMPL_VAR NAME="term" -->=<!-- TMPL_VAR NAME="val" ESCAPE=URL -->&amp;<!-- /TMPL_LOOP -->resultsperpage=<!-- TMPL_VAR NAME="resultsperpage" -->&amp;type=intranet&amp;op=do_search">&lt;&lt;Previous</a><!-- /TMPL_IF -->
				<!-- TMPL_LOOP NAME="numbers" --><!-- TMPL_IF NAME="highlight" --> <span class="highlight"><!-- TMPL_VAR NAME="number" --></span><!-- TMPL_ELSE --> <a class="resultnumber" href="/cgi-bin/koha/plugin_launcher.pl?plugin_name=unimarc_field_4XX.pl&amp;index=<!--TMPL_VAR Name="index"-->&amp;startfrom=<!-- TMPL_VAR NAME="startfrom" -->&amp;<!-- TMPL_LOOP NAME="searchdata" --><!-- TMPL_VAR NAME="term" -->=<!-- TMPL_VAR NAME="val" ESCAPE=URL -->&amp;<!-- /TMPL_LOOP -->resultsperpage=<!-- TMPL_VAR NAME="resultsperpage" -->&amp;type=intranet&amp;op=do_search"><!-- TMPL_VAR NAME="number" --></a><!-- /TMPL_IF --><!-- /TMPL_LOOP --> <!-- TMPL_IF NAME="displaynext" --><a class="resultnumber" href="/cgi-bin/koha/plugin_launcher.pl?plugin_name=unimarc_field_4XX.pl&amp;index=<!--TMPL_VAR Name="index"-->&amp;startfrom=<!-- TMPL_VAR NAME="startfromnext" -->&amp;<!-- TMPL_LOOP NAME="searchdata" --><!-- TMPL_VAR NAME="term" -->=<!-- TMPL_VAR NAME="val" ESCAPE=URL -->&amp;<!-- /TMPL_LOOP -->&amp;resultsperpage=<!-- TMPL_VAR NAME="resultsperpage" -->&amp;type=intranet&amp;op=do_search">Next&gt;&gt;</a><!-- /TMPL_IF --></p>
		</div>
	
		<script language="JavaScript" type="text/javascript">
		
		function jumpfull(page)
		{	
			window.open(page,'','fullscreen,scrollbars');
		}
		</script>
		
	<!--/TMPL_IF-->
	</div>
	</body>
<!--/TMPL_IF -->
</html>
