[% INCLUDE "intranet-top.inc" %]

<script src="/includes/jquery/validate/jquery.validate.js"></script>

<script language="javascript" type="text/javascript">

$(document).ready(function() {
    crearDatePicker('begindate');
    crearDatePicker('enddate');
});
</script>

<script type="text/javascript">

</script>


<script language="JavaScript">


function enviarMails(){
	location.href='/cgi-bin/koha/reports/mailvencidos.pl';
}

function ocultarBoton(estado){
	var botonMail=$("#contacto");
	if(estado != "VE"){
		botonMail.hide();
	}
	else{
		botonMail.show();
	}
}

var objAH;

function changePage(ini){
	objAH.changePage(ini);
}

function ordenar(orden){
	objAH.sort(orden);
}

function consultar(){
	objAH=new AjaxHelper(updateInfo);
	objAH.url="/cgi-bin/koha/reports/prestamosResult.pl";
	objAH.id_ui=$("#id_ui").val();
	objAH.begindate=$("#begindate").val();
	objAH.enddate=$("#enddate").val();
	objAH.estado=$("#estado").val();
    renglones = $("#renglones").val();
    if (!isNaN(renglones))
    	objAH.renglones=renglones;
	objAH.funcion= "changePage";
	objAH.sendToServer();	
}

function updateInfo(responseText){
	$("#result").html(responseText);
	var estado=$("#estado").val();
	zebra("tablaResult");
	ocultarBoton(estado);
// 	checkedAll('checkAllPrestamos','chkboxPrestamos');
}

// FIXME no se esta usando creo?
// function checkedAll(){
// 	var checks=document.getElementsByTagName("input");
// 	if (checks.length>0){
// 		for(i=0;i<checks.length;i++){
// 			if(checks[i].type == "checkbox"){
// 				if(checks[i].checked){checks[i].checked=false}
//                    	 	else{checks[i].checked=true}
// 			}
// 		}
// 	}
// }

</script>

<div class="titulos_interior" >[% "Pr&eacute;stamos" | i18n %]</div>

[% IF msg %]
    <p>
        <font color='red' size='2'>[% "Mail enviado a usuarios con pr&eacute;stamos vencidos. " | i18n %]
        </font>
    </p>
[% END %]

<br>
<div class="filtros_reportes">
    <ul class="filtros_reportes_izq">
        <li><h2>[% "Fecha de Vencimiento" | i18n %]</h2></li>
		<li>[% "Seleccione una fecha de inicio:" | i18n %]</li>
		<li>
			<input id="begindate" class="inputFontNormal" name="begindate"></a>
		</li>
        <li>[% "Seleccione una fecha de fin:" | i18n %]</li>
        <li>
            <input id="enddate" class="inputFontNormal" name="enddate">
        </li>

    </ul>

    <ul class="filtros_reportes_der">
		<li>[% "Seleccione una unidad de informaci&oacute;n:&nbsp;" | i18n %]</li>
		<li>[% unidades %]</li>
        <li>[% "Seleccione estado de prestamo:&nbsp;" | i18n %]</li>
        <li>
            <select name="estado" id="estado">
                <option value="VE" id="VE">[% "Vencidos" | i18n %]</option>
                <option value="NV" id="NV">[% "No vencidos" | i18n %]</option>
                <option value="TO" id="TO" selected>[% "Todos" | i18n %]</option>
            </select>
        </li>

        <li>[% "Cantidad de resultados por p&aacute;gina:" | i18n %]</li>
		<li>
			<select name="renglones" id="renglones">
				<option value="5" id="5">5</option>
				<option value="10" id="10">10</option>
				<option value="15" id="15">15</option>
				<option value="20" id="20">20</option>
				<option value="25" id="25">25</option>
				<option value="50" id="50">50</option>
				<option value="100" id="100">100</option>
				<option value="todos" id="todos" selected>[% "Todos" | i18n %]</option>
			</select>
		</li>
    </ul>
</div>
<div class="buttonContainerHorizontal">
    [% PERL %]
                    print C4::AR::Filtros::to_Button( 
                                                        text    =>  "[% 'Buscar' | i18n %]",
                                                        boton   =>  "boton_buscar",
                                                        onClick =>  "consultar();",
                            ) ;
    [% END %]
</div>

<div id="result"></div>

[% INCLUDE "intranet-bottom.inc" %]