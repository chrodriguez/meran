[% INCLUDE "intranet-top.inc" %]

<script src="/intranet-tmpl/includes/circulacion.js"></script>

<script language=javascript>
function todos(){
	var checks=document.getElementsByTagName("input");
	if (checks.length>0){
		for(i=0;i<checks.length;i++){
			if(checks[i].type == "checkbox"){
        			if(checks[i].checked){checks[i].checked=false}
				else{checks[i].checked=true}
			}
		}
	}
}

var objAH;//Objeto AjaxHelper.

/*
 * borrarDiv
 * Borra el div 
 */
function borrarDiv(){$("#divResultado").html("");}

/*
 * buscarSanciones
 * Busca todas las sanciones.
 */
function buscarSanciones(){
	objAH=new AjaxHelper(updateBuscarSanciones);
	objAH.debug= true;
	objAH.url= "/cgi-bin/koha/circ/sancionesDB.pl";
	objAH.sendToServer();
}
function updateBuscarSanciones(responseText){
	$("#divResultado").html(responseText);
}

function borrarSanciones(chck){

    var chck=$("input[@name="+chck+"]:checked");
    var array= new Array;
    var long=chck.length;
    if ( long == 0){
        alert("Elija al menos una sanciona para eliminar");
    }
    else{

//         var is_confirmed = confirm('Esta seguro que desea cancelar la sancion?');
//         if (is_confirmed) {
        jConfirm(ESTA_SEGURO_QUE_DESEA_CANCELAR_LA_SANCION,SANCIONES_TITLE, function(confirmStatus){if (confirmStatus) {

            for(var i=0; i< long; i++){
            array[i]=chck[i].value;
            }

            objAH=new AjaxHelper(updateSanciones);
            objAH.debug= true;
            objAH.url= '/cgi-bin/koha/circ/borrarsanciones.pl';
            objAH.datosArray= array;
            //se envia la consulta
            objAH.sendToServer();
        }

        });
    }
}


function updateSanciones(responseText){

	borrarDiv();

	var infoHash= JSONstring.toObject(responseText);
	var messageArray= infoHash.Messages_arrayref;
	setMessages(messageArray);

	buscarSanciones();
}


$(document).ready( function() {
	buscarSanciones();
});



</script>

<center>

<div class="titulos_interior" >[% "Sanciones" | i18n %]</div>

<div id="divResultado"></div>

[% INCLUDE "intranet-bottom.inc" %]
