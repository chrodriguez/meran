[% INCLUDE   'intranet-top.inc'  %]
<script src="/includes/jquery/jquery-highlight.js"></script>
<script language="javascript" type="text/javascript">

var objAH;
var globalSearchTemp;
function ordenar(orden){
	objAH.sort(orden);
}

function changePage(ini){
	objAH.changePage(ini);
}

function consultar(filtro){
	objAH=new AjaxHelper(updateInfo);
    objAH.cache = true;
	busqueda = jQuery.trim($('#socio').val());
	inicial = '0';
	if (filtro){
		inicial = filtro;
		busqueda = jQuery.trim(filtro);
		objAH.inicial= inicial;
		$('#socio').val("filtro: "+filtro);
	}
	else
	   {
		if (busqueda.substr(8,5).toUpperCase() == 'TODOS'){
				busqueda = busqueda.substr(8,5);
				$('#socio').val(busqueda);
				consultar(busqueda);
		}
		else
		   {
			if (busqueda.substr(0,6).toUpperCase() == 'FILTRO'){
				busqueda = busqueda.substr(8,1);
				$('#socio').val(busqueda);
				consultar(busqueda);
			}
		   }

			
	}
	if(busqueda.length > 0){
		objAH.url= '/cgi-bin/koha/usuarios/reales/buscarUsuarioResult.pl';
		objAH.debug= true;
// 		objAH.cache= true;
		objAH.funcion= 'changePage';
		objAH.socio= busqueda;
		objAH.sendToServer();
	}
	else{
		alert("Ingrese un dato");
		$('#socio').focus();
	}

}

function updateInfo(responseText){
	$('#result').html(responseText);
	zebra('tablaResult');
    var idArray = [];
    var classes = [];
    idArray[0] = 'socio';
    classes[0] = 'nomCompleto';
    classes[1] = 'documento';
    classes[2] = 'legajo';
    busqueda = jQuery.trim($('#socio').val());
    if (busqueda.substr(0,6).toUpperCase() != 'FILTRO') //SI NO SE QUISO FILTRAR POR INICIAL, NO TENDRIA SENTIDO MARCARLO
        highlight(classes,idArray);
}

function Borrar(){
	$('#socio').val('');
}

function checkFilter(eventType){
	var str = $('#socio').val();
	
	if (eventType.toUpperCase() == 'FOCUS'){

		if (str.substr(0,6).toUpperCase() == 'FILTRO'){
			globalSearchTemp = $('#socio').val();
			Borrar();
		}
	}
	else
	   {
		if (jQuery.trim($('#socio').val()) == "")
			$('#socio').val(globalSearchTemp);
	   }
}

$(document).ready(function() {
	//onEnter con foco en input, ejecuta la busqueda
	onEnter("socio",consultar);
});

</script>

<table width="100%"  border="0" cellpadding="0" cellspacing="0" align="center">
	<tr>
		<td class="pagetitle" >[% "B&uacute;squeda de Usuarios Reales" | i18n %]</td>
	</tr>
	<tr>
		<td class="lineagruesa"  align="left" colspan="3"></td>
	</tr>

</table>
<center>
<br><br><br>
<table>
	<tr>
 		<td>
			<input id="socio" class="inputFontNormal" type=text name="socio" onFocus="checkFilter('focus')" 
                onBlur="checkFilter('blur')" value="[% socio %]">
		</td>
 		<td>
			<input id="buscar" type="image" onClick="consultar('');" src="[% themelang %]/images/boton-buscar.png" border='0'>

 			<input type="image" onClick="Borrar();" alt="Limpiar" src="[% themelang %]/images/borrar2.png" border="0" > 
		</td>
	</tr>
	<tr>
		<td class="inputFontNormal" colspan=2>
			<p class="recuadroAyuda">
			[% "Tipear el apellido, DNI o legajo del usuario. Presionar buscar" | i18n %]
			</p>
		</td>
	</tr>
</table>
</center>
<div id="filterBar" style="text-align:center">
		<a href="#tablaResult" onClick="consultar('A')"> A |</a>
		<a href="#tablaResult" onClick="consultar('B')"> B |</a>
		<a href="#tablaResult" onClick="consultar('C')"> C |</a>
		<a href="#tablaResult" onClick="consultar('D')"> D |</a>
		<a href="#tablaResult" onClick="consultar('E')"> E |</a>
		<a href="#tablaResult" onClick="consultar('F')"> F |</a>
		<a href="#tablaResult" onClick="consultar('G')"> G |</a>
		<a href="#tablaResult" onClick="consultar('H')"> H |</a>
		<a href="#tablaResult" onClick="consultar('I')"> I |</a>
		<a href="#tablaResult" onClick="consultar('j')"> J |</a>
		<a href="#tablaResult" onClick="consultar('K')"> K |</a>
		<a href="#tablaResult" onClick="consultar('L')"> L |</a>
		<a href="#tablaResult" onClick="consultar('M')"> M |</a>
		<a href="#tablaResult" onClick="consultar('N')"> N |</a>
		<a href="#tablaResult" onClick="consultar('O')"> O |</a>
		<a href="#tablaResult" onClick="consultar('P')"> P |</a>
		<a href="#tablaResult" onClick="consultar('Q')"> Q |</a>
		<a href="#tablaResult" onClick="consultar('R')"> R |</a>
		<a href="#tablaResult" onClick="consultar('S')"> S |</a>
		<a href="#tablaResult" onClick="consultar('T')"> T |</a>
		<a href="#tablaResult" onClick="consultar('U')"> U |</a>
		<a href="#tablaResult" onClick="consultar('V')"> V |</a>
		<a href="#tablaResult" onClick="consultar('W')"> W |</a>
		<a href="#tablaResult" onClick="consultar('X')"> X |</a>
		<a href="#tablaResult" onClick="consultar('Y')"> Y |</a>
		<a href="#tablaResult" onClick="consultar('Z')"> Z |</a>
		<a href="#tablaResult" onClick="consultar('TODOS')"> [% "TODOS" | i18n %] </a>
		
</div>

<br>
<div id="result"></div>
<br>

[% INCLUDE 'intranet-bottom.inc' %]

