[% INCLUDE "intranet-top.inc" %]

<script type="text/javascript" src="/intranet-tmpl/includes/circulacion-min.js"></script>

<script language=javascript>
function todos(){
	var checks=document.getElementsByTagName("input");
	if (checks.length>0){
		for(i=0;i<checks.length;i++){
			if(checks[i].type == "checkbox"){
        			if(checks[i].checked){checks[i].checked=false}
				else{checks[i].checked=true}
			}
		}
	}
}

var objAH;//Objeto AjaxHelper.
var ORDEN;//orden
/*
 * borrarDiv
 * Borra el div 
 */
function borrarDiv(){$("#divResultado").html("");}

/*
 * buscarSanciones
 * Busca todas las sanciones.
 */
function buscarSanciones(){
	objAH=new AjaxHelper(updateBuscarSanciones);
	objAH.debug= true;
    objAH.showOverlay = true;
    objAH.orden= ORDEN;
	objAH.url= "/cgi-bin/koha/circ/sancionesDB.pl";
	objAH.sendToServer();
}
function updateBuscarSanciones(responseText){
	$("#divResultado").html(responseText);
    zebra('datos_tabla');

}

function ordenar(orden){
    ORDEN=orden;
    buscarSanciones();
}

function borrarSanciones(chck){

    var chck=$("input[@name="+chck+"]:checked");
    var array= new Array;
    var long=chck.length;
    if ( long == 0){
        jAlert("Elija al menos una sanciona para eliminar");
    }
    else{

        jConfirm(ESTA_SEGURO_QUE_DESEA_CANCELAR_LA_SANCION,SANCIONES_TITLE, function(confirmStatus){if (confirmStatus) {

            for(var i=0; i< long; i++){
            array[i]=chck[i].value;
            }

            objAH=new AjaxHelper(updateSanciones);
            objAH.debug= true;
            objAH.showOverlay = true;
            objAH.url= '/cgi-bin/koha/circ/borrarsanciones.pl';
            objAH.datosArray= array;
            //se envia la consulta
            objAH.sendToServer();
        }

        });
    }
}


function updateSanciones(responseText){

	borrarDiv();

	var infoHash= JSONstring.toObject(responseText);
	var messageArray= infoHash.Messages_arrayref;
	setMessages(messageArray);

	buscarSanciones();
}


$(document).ready( function() {
	buscarSanciones();
});



</script>

<center>
<fieldset class="resultados_busqueda">
    <legend class="titulo_legend">[% "Sanciones" | i18n %]</legend>
    <div id="divResultado"></div>
</fieldset>
[% INCLUDE "intranet-bottom.inc" %]
