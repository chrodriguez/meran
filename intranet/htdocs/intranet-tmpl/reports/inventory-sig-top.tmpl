[% INCLUDE "intranet-top.inc" %]

<script type="text/javascript" src="/intranet-tmpl/estadisticas/estadisticas.js"></script>
<script type="text/javascript" src="/intranet-tmpl/includes/adquisiciones/tabletojson.js"> </script>

<script>

    function ordenar(orden){
	    objAH.sort  = orden;
        objAH.debug = true;
        objAH.showOverlay       = true;
	    objAH.sendToServer();
    }

    function changePage(ini){
        objAH.changePage(ini);
    }


    function consultarPorBarcode(){
    
        //se busca por barcode
        if ( ($("#barcode").val() == "")&&(($("#desde_barcode").val() == "")||($("#hasta_barcode").val() == "")) ){
            jAlert(DEBE_INGRESAR_EL_BARCODE);
            $("#desde_barcode").focus();
  
            return;
        }


        if ( ($("#barcode").val() == "")&&(($("#desde_barcode").val() == "")&&($("#hasta_barcode").val() == "")) ){

        //se busca el barcode por rango
      
            jAlert(DEBE_INGRESAR_EL_BARCODE);
            $("#barcode").focus();
  
            return;
        }


        objAH                   = new AjaxHelper(updateInfo);
        objAH.debug             = true;
        objAH.showOverlay       = true;
        objAH.url               = URL_PREFIX+"/reports/inventory-sig-topResult.pl";
        objAH.barcode           = $("#barcode").val();
        objAH.desde_barcode     = $("#desde_barcode").val();
        objAH.hasta_barcode     = $("#hasta_barcode").val();
        objAH.accion            = "CONSULTA_POR_BARCODE";
        objAH.funcion           = "changePage";
        objAH.id_ui            = $("#combo_ui_barcode").val();
        objAH.tipoUI            = $("input[name=uibarcode]:checked").val();
        //se envia la consulta
        objAH.sendToServer();
        $('#result').show();
        $('#reporteCreado').hide();
    }
    
    function consultarPorSignatura(){
     

        //se busca por signatura
        if ( ($("#sigtop").val() == "")&&(($("#desde_signatura").val() == "")||($("#hasta_signatura").val() == "")) ){
            jAlert(DEBE_INGRESAR_LA_SIGNATURA);
            $("#desde_signatura").focus();
  
            return;
        }

        //se busca la signatura por rango
        if ( ($("#sigtop").val() == "")&&(($("#desde_signatura").val() == "")&&($("#hasta_signatura").val() == "")) ){
            jAlert(DEBE_INGRESAR_LA_SIGNATURA);
            $("#sigtop").focus();
  
            return;
        }


	    objAH                   = new AjaxHelper(updateInfo);
        objAH.debug             = true;
        objAH.showOverlay       = true;
	    objAH.url               = URL_PREFIX+"/reports/inventory-sig-topResult.pl";
	    objAH.sigtop            = $("#sigtop").val();
        objAH.desde_signatura   = $("#desde_signatura").val();
        objAH.hasta_signatura   = $("#hasta_signatura").val();
        objAH.accion            = "CONSULTA_POR_SIGNATURA";
        objAH.funcion           = "changePage";
        objAH.id_ui             = $("#combo_ui_signatura").val();
        objAH.tipoUI            = $("input[name='uisignatura']:checked").val();
	    //se envia la consulta
	    objAH.sendToServer();
        $('#result').show();
        $('#reporteCreado').hide();
      }
    
     function exportarXLS(){
        objAH                   = new AjaxHelper(updateExportarXLS);
        objAH.debug             = true;
        objAH.showOverlay       = true;
        objAH.url               = URL_PREFIX+"/reports/inventory-sig-topResult.pl";
        objAH.sigtop            = $("#sigtop").val();
        objAH.desde_signatura   = $("#desde_signatura").val();
        objAH.hasta_signatura   = $("#hasta_signatura").val();
        objAH.barcode           = $("#barcode").val();
        objAH.desde_barcode     = $("#desde_barcode").val();
        objAH.hasta_barcode     = $("#hasta_barcode").val();
        objAH.accion            = "EXPORTAR_XLS";
        objAH.funcion           = "changePage";
        objAH.id_uisignatura    = $("#combo_ui_signatura").val();
        objAH.id_uibarcode      = $("#combo_ui_barcode").val();
        objAH.tipoUISignatura   = $("input[@name='uisignatura']:checked").val();
        objAH.tipoUIBarcode     = $("input[@name='uibarcode']:checked").val();
        //se envia la consulta
        objAH.sendToServer();
        $('#result').hide();
        $('#reporteCreado').show();
    }
    
    function updateExportarXLS(responseText){
        $("#reporteCreado").html(responseText);
    }

  

    function updateInfo(responseText){
	    $("#result").html(responseText);
	    zebra("datos_tabla");
    }

    function onClickBarcode(){
        $('#barcode').click(function() {
            $('#desde_barcode').val('');
            $('#hasta_barcode').val('');
            $('#sigtop').val('');
            $('#hasta_signatura').val('');
            $('#desde_signatura').val('');
        });
    }

    function onClickDesdeHastaBarcode(){
        $('#desde_barcode').click(function() {
            $('#barcode').val('');
            $('#sigtop').val('');
            $('#hasta_signatura').val('');
            $('#desde_signatura').val('');
        });

        $('#hasta_barcode').click(function() {
            $('#barcode').val('');
            $('#sigtop').val('');
            $('#hasta_signatura').val('');
            $('#desde_signatura').val('');
        });
    }

    function onClickSignatura(){
        $('#sigtop').click(function() {
            $('#desde_signatura').val('');
            $('#hasta_signatura').val('');
            $('#barcode').val('');
            $('#hasta_barcode').val('');
            $('#desde_barcode').val('');
        });
    }

    function onClickDesdeHastaSignatura(){
        $('#desde_signatura').click(function() {
            $('#sigtop').val('');
            $('#barcode').val('');
            $('#hasta_barcode').val('');
            $('#desde_barcode').val('');
        });

        $('#hasta_signatura').click(function() {
            $('#sigtop').val('');
            $('#barcode').val('');
            $('#hasta_barcode').val('');
            $('#desde_barcode').val('');
        });
    }

    $(document).ready(function() {
        //onEnter con foco en input, ejecuta la busqueda
        onEnter("barcode",consultarPorBarcode);
        onEnter("desde_barcode",consultarPorBarcode);
        onEnter("hasta_barcode",consultarPorBarcode);
        onEnter("sigtop",consultarPorSignatura);
        onEnter("desde_signatura",consultarPorSignatura);
        onEnter("hasta_signatura",consultarPorSignatura);
        onClickBarcode();
        onClickSignatura();
        onClickDesdeHastaBarcode();
        onClickDesdeHastaSignatura();
        $('#reporteCreado').hide();
      
    });

</script>

<!--<div class="titulos" >[% "Inventario por signatura topogr&aacute;fica / nro. inventario:" | i18n %]</div>-->
 <fieldset id="reportes">
    <legend class="titulo_legend"> <span class="titulos">[% "Inventario por signatura topogr&aacute;fica / nro. inventario" | i18n %] </span> </legend>
<fieldset>
    <legend class="titulo_legend">[% "Buscar signatura topogr&aacute;fica: &nbsp;" | i18n %]</legend>
        <ul>
            <li class="sub_item">
              <label for="sigtop">Signatura</label>
              <input type="text" id="sigtop" value="[% sigtop %]">
            </li>
<!--            <li class="sub_item">
                Min: [% signatura_min %] 
                Max: [% signatura_max %]
            </li>-->
            <li class="sub_item">
              <label for="desde_signatura">[% "Desde" | i18n %]</label>
              <input type="text" id="desde_signatura" value="[% desde_signatura %]"> Min: [% signatura_min %] 
            </li>
            <li class="sub_item">
              <label for="hasta_signatura">[% "Hasta" | i18n %]</label>
              <input type="text" id="hasta_signatura" value="[% hasta_signatura %]"> Max: [% signatura_max %] 
            </li>
            <li class="sub_item">
                <label for="radio">[% "Unidad de Informacion" | i18n %]</label>
                <input type="radio" name="uisignatura" value="Origen" checked>Origen
                <input type="radio" name="uisignatura" value="Poseedora" >Poseedora<br>
                <label for="ui"></label>
                  [% combo_ui_signatura %]
            </li>
        

            [% PERL %]
                            print C4::AR::Filtros::to_Button( 
                                                                text    =>  "[% 'Buscar' | i18n %]",
                                                                boton   =>  "boton_buscar",
                                                                onClick =>  "consultarPorSignatura();",
                                    ) ;
            [% END %]
        </ul>
</fieldset>

<fieldset>
    <legend class="titulo_legend">[% "Buscar nro. inventario: &nbsp;" | i18n %]</legend>
        <ul>
            <li class="sub_item">
              <label for="barcode">Nro. Inventario</label>
              <input type="text" id="barcode" value="[% barcode %]">
            </li>
            <li class="sub_item">
              <label for="desde_barcode">[% "Desde" | i18n %]</label>
              <input type="text" id="desde_barcode" value="[% desde_barcode %]"> Min: [% barcode_min %] 
            </li>
            <li class="sub_item">
              <label for="hasta_barcode">[% "Hasta" | i18n %]</label>
              <input type="text" id="hasta_barcode" value="[% hasta_barcode %]"> Max: [% barcode_max %] 
            </li>
         <li class="sub_item">
                <label for="radio">[% "Unidad de Informacion" | i18n %]</label>
                <input type="radio" name="uibarcode" value="Origen" checked>Origen
                <input type="radio" name="uibarcode" value="Poseedora" >Poseedora<br>
                <label for="ui"></label>
                  [% combo_ui_barcode %]      
            </li>
         

            [% PERL %]
                            print C4::AR::Filtros::to_Button( 
                                                                text    =>  "[% 'Buscar' | i18n %]",
                                                                boton   =>  "boton_buscar",
                                                                onClick =>  "consultarPorBarcode();",
                                    ) ;
            [% END %]
        </ul>
</fieldset>

<br>
<div id="reporteCreado" style="border: 1px solid #7E94AF; text-align:center; background-color: #CCCCCC; color:#505050; padding:10px 0 0 0; margin: 0 0 10px 0">
</div>

<div id="result"></div>
</fieldset>

[% INCLUDE "intranet-bottom.inc" %]
