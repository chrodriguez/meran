[% INCLUDE "intranet-top.inc" %]

<script src="/includes/jquery/jquery-highlight-min.js"></script>
<script src="/intranet-tmpl/includes/usuarios/usuariosPotenciales.js"></script>

<script type="text/javascript">


function ordenar(orden){
    objAH.sort(orden);
}

function changePage(ini){
    objAH.changePage(ini);
}


var busqueda_armed,incial_armed;
var flag_armed = false;

function consultar(filtro){
    
    busqueda = jQuery.trim($('#persona').val());
    inicial = '0';
    if (filtro){
        inicial = filtro;
        busqueda = jQuery.trim(filtro);
        $('#persona').val("filtro: "+filtro);
    }
    else
       {
        if (busqueda.substr(8,5).toUpperCase() == 'TODOS'){
                busqueda = busqueda.substr(8,5);
                $('#persona').val(busqueda);
                consultar(busqueda);
        }
        else
           {
            if (busqueda.substr(0,6).toUpperCase() == 'FILTRO'){
                busqueda = busqueda.substr(8,1);
                $('#persona').val(busqueda);
                consultar(busqueda);
            }
           }

    }
    if(busqueda.length > 0){
        busqueda_armed = busqueda;
        inicial_armed = inicial;
        flag_armed = true;
		buscarUsuariosPotenciales();
    }
    else{
        jAlert(INGRESE_UN_DATO);
        $('#persona').focus();
    }

}


function buscarUsuariosPotenciales(){
    objAH=new AjaxHelper(updateInfo);
    objAH.showOverlay       = true;
    objAH.debug= true;
    objAH.url=URL_PREFIX+"/usuarios/potenciales/buscarUsuarioResult.pl";
    objAH.funcion= "changePage";

    if (flag_armed){
        objAH.persona = busqueda_armed;
        objAH.inicial = inicial_armed;
    }else{   
        var busqueda = $("#persona").val();
	    if(busqueda != ""){
		    objAH.persona= busqueda;
	    }
	    else{
		    jAlert(INGRESE_UN_DATO);
            $("#persona").focus();
	    }
    }

	objAH.habilitados_filter = 0;
    if ($("#habilitados_filter").attr('checked'))  
        objAH.habilitados_filter = 1;

    objAH.sendToServer();
}

function updateInfo(responseText){
	$("#result").html(responseText);
	zebra("datos_tabla");
    var idArray = [];
    var classes = [];
    idArray[0] = 'persona';
    classes[0] = 'nomCompleto';
    classes[1] = 'documento';
    busqueda = jQuery.trim($('#persona').val());
  //  if (busqueda.substr(0,6).toUpperCase() != 'FILTRO') //SI NO SE QUISO FILTRAR POR INICIAL, NO TENDRIA SENTIDO MARCARLO
//      highlight(classes,idArray);
}

function Borrar(){
    $('#persona').val('');
}

function checkFilter(eventType){
    var str = $('#persona').val();
    
    if (eventType.toUpperCase() == 'FOCUS'){

        if (str.substr(0,6).toUpperCase() == 'FILTRO'){
            globalSearchTemp = $('#persona').val();
            Borrar();
        }
    }
    else
       {
        if (jQuery.trim($('#persona').val()) == "")
            $('#persona').val(globalSearchTemp);
       }
}


$(document).ready(function() {
	onEnter("persona",consultar);
});

</script>


<!--<div class="titulos">[% "B&uacute;squeda de Usuarios Potenciales" | i18n %]</div>-->
<fieldset>
    <legend class="titulo_legend">[% "B&uacute;squeda de Usuarios Potenciales" | i18n %]</legend>
      <p id="msj" style="font-size:12pt; color:red"></p>


      <section class="center-section-form">
        <form class="form-horizontal">
          <div class="control-group">
              <div class="controls">
             <!--     <input id="buscar" class="textInput" type="text" value="" name="buscar">-->
                  <input id="persona" class="textInput" type=text name="persona" value="[% persona %]" onFocus="checkFilter('focus')" onBlur="checkFilter('blur')"> 
        
                  <p class="help-block">
                      <span class="label label-info">NOTA</span>
                      [% "Tipear el apellido, DNI o legajo del usuario. Presionar buscar." | i18n %]
                  </p>
              </div>
          </div>
  
          <div class="form-actions">
                      [% PERL %]
                              print C4::AR::Filtros::action_button(
                                                              button       => "btn click",
                                                              action       => "Borrar();",
                                                              icon         => "",
                                                              title        => "[% 'Limpiar' | i18n %]",
                                                          ) ;

                      [% END %]
                      [% PERL %]
                              print C4::AR::Filtros::action_button(
                                                              button       => "btn btn-primary",
                                                              action       => "buscarUsuariosPotenciales();",
                                                              icon         => "",
                                                              title        => "[% 'Buscar' | i18n %]",
                                                          ) ;

                      [% END %]
                    
                      
          </div>
        </form>
      
</section>


<!--<div class="buttonContainerHorizontal">
<ul>
    <li class="filtros">
			<input id="persona" type=text name="persona" value="[% persona %]" onFocus="checkFilter('focus')" 
                onBlur="checkFilter('blur')">

            [% PERL %]
                                print C4::AR::Filtros::to_Button(   text    => "[% 'Buscar' | i18n %]",
                                                                    boton   => "boton_buscar",
                                                                    onClick => "buscarUsuariosPotenciales();",
                                                                    title   => "[% 'Buscar' | i18n %]",
                                                                    inline  => 1,
                                        ) ;
            [% END %]
            [% PERL %]
                                print C4::AR::Filtros::to_Button(   text    => "[% 'Limpiar' | i18n %]",
                                                                    boton   => "boton_buscar",
                                                                    onClick => "Borrar();",
                                                                    title   => "[% 'Limpiar' | i18n %]",
                                                                    inline  => 1,
                                        ) ;
            [% END %]


    </li>
</ul>
</div>
<ul>
    <li style="text-align:center">
			<p class="recuadroAyuda">
			 [% "Tipear el apellido, DNI o legajo del usuario. Presionar buscar." | i18n %]
			</p>
    </li>
</ul>-->

<fieldset>
    <legend class="titulo_legend">[% "B&uacute;squeda por inicial del apellido" | i18n %]</legend>
    <div id="filterBar" style="text-align:center">
        <a href="#tablaResult" onClick="consultar('A')"> A |</a>
        <a href="#tablaResult" onClick="consultar('B')"> B |</a>
        <a href="#tablaResult" onClick="consultar('C')"> C |</a>
        <a href="#tablaResult" onClick="consultar('D')"> D |</a>
        <a href="#tablaResult" onClick="consultar('E')"> E |</a>
        <a href="#tablaResult" onClick="consultar('F')"> F |</a>
        <a href="#tablaResult" onClick="consultar('G')"> G |</a>
        <a href="#tablaResult" onClick="consultar('H')"> H |</a>
        <a href="#tablaResult" onClick="consultar('I')"> I |</a>
        <a href="#tablaResult" onClick="consultar('j')"> J |</a>
        <a href="#tablaResult" onClick="consultar('K')"> K |</a>
        <a href="#tablaResult" onClick="consultar('L')"> L |</a>
        <a href="#tablaResult" onClick="consultar('M')"> M |</a>
        <a href="#tablaResult" onClick="consultar('N')"> N |</a>
        <a href="#tablaResult" onClick="consultar('O')"> O |</a>
        <a href="#tablaResult" onClick="consultar('P')"> P |</a>
        <a href="#tablaResult" onClick="consultar('Q')"> Q |</a>
        <a href="#tablaResult" onClick="consultar('R')"> R |</a>
        <a href="#tablaResult" onClick="consultar('S')"> S |</a>
        <a href="#tablaResult" onClick="consultar('T')"> T |</a>
        <a href="#tablaResult" onClick="consultar('U')"> U |</a>
        <a href="#tablaResult" onClick="consultar('V')"> V |</a>
        <a href="#tablaResult" onClick="consultar('W')"> W |</a>
        <a href="#tablaResult" onClick="consultar('X')"> X |</a>
        <a href="#tablaResult" onClick="consultar('Y')"> Y |</a>
        <a href="#tablaResult" onClick="consultar('Z')"> Z |</a>
        <a href="#tablaResult" onClick="consultar('TODOS')"> [% "TODOS" | i18n %] </a>
    </div>
</fieldset>
<div><br><br>
    <input type="checkbox" name="habilitados_filter" id="habilitados_filter">[% " Mostrar s&oacute;lo usuarios habilitados"| i18n %]
</div>

<br>
<div id="result"></div>

</fieldset>

[% INCLUDE "intranet-bottom.inc" %]

