--Estas sentencias se aplican a instalaciones de koha de la version 2007 version posterior a septiembre de 2007
-- Son necesarias para normalizar los temas en el catalogo
--
-- Table structure for table `autores`
--
--Creo una tabla de referencia de temas
DROP TABLE IF EXISTS `temas`;
CREATE TABLE `temas` (
  `id` int(11) NOT NULL auto_increment,
  `nombre` text NOT NULL,
  PRIMARY KEY  (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;


delete from temas;
--Inserto todos los temas en una tabla de referencias
insert into temas (nombre) select distinct subject from bibliosubject;
--Actualizo la tabla de referencia nXn entre biblioitem y temas  
update bibliosubject set subject = (select id from temas where nombre=subject);

-- --------------------------------------------------------
--Agrego los datos necesarios para manejarlo desde la interfaz de manejo generica de tabla de referencia
--INSERT INTO `tablasDeReferencias` (`referencia`, `nomcamporeferencia`, `camporeferencia`, `referente`, `camporeferente`) VALUES ('temas', 'id', 0, 'bibliosubject', 'subject');
--INSERT INTO `tablasDeReferenciasInfo` (`orden`, `referencia`, `similares`) VALUES ('nombre', 'temas', 'nombre');
